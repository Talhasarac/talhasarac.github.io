(function(){"use strict";const P=navigator.webdriver||/bot|spider/i.test(navigator.userAgent),C=!!document.querySelector(".header-user-avatar"),U=document.querySelector(".scope-app"),m=parseInt(U.dataset.appid,10),M=U.dataset.chartsType,ne=U.dataset.defaultTab;let Y=!1;const x=function(){const n=document.querySelector('time[itemprop="datePublished"]');if(!n)return null;const s=new Date(n.dateTime).getTime();return s>Date.now()?null:s}();TimeAgo.initAll(".timeago"),window.SteamDB.OnExtensionUserdataLoaded(()=>{let n=window.SteamDB.OwnedApps.has(m);if(!n&&document.querySelector("#subs .package.owned")&&(n=!0),n){const e=document.querySelector("#js-app-install");e.classList.add("owned"),e.querySelector("span").textContent="Owned"}const s=document.querySelectorAll("#depots tr.depot");for(const e of s){if(window.SteamDB.OwnedApps.has(+e.dataset.depotid)){e.classList.add("owned");continue}let r=e.dataset.packages;if(r.length){r=r.split(",");for(const a of r)if(window.SteamDB.OwnedPackages.has(+a)){e.classList.add("owned");break}}}}),document.querySelectorAll(".app-logo").forEach(n=>{n.addEventListener("error",function(){this.src="/static/img/applogo.svg"},{once:!0})});const V=document.getElementById("js-watch");V&&V.addEventListener("click",function(n){if(n.preventDefault(),this.classList.contains("disabled"))return;const s=this.dataset.watched==="true";this.classList.add("disabled");const e=new FormData;e.append("appid",m),fetch(s?"/api/Unwatch/":"/api/Watch/",{method:"POST",body:e,headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(r=>r.json()).then(r=>{if(!r||!r.success){const l=new Error(r.error||"Something went wrong.");throw l.name="ServerError",l}let a=!1;if("BroadcastChannel"in window){let l=null;try{l=new BroadcastChannel("steamdb-extension"),l.postMessage({type:"steamdb:extension-response",request:{contentScriptQuery:s?"Unwatch":"Watch",appid:m},response:{success:!0}}),a=!0}catch{}}a||(this.classList.toggle("watched",!s),this.dataset.watched=!s,this.querySelector("#js-watch-text").textContent=s?"Watch":"Unwatch")}).catch(r=>{throw window.SteamDB.Alert(`Failed to watch: ${r}`),r}).finally(()=>{this.classList.remove("disabled")})});const W=document.querySelector(".js-open-screenshot-viewer");W&&window.SteamDB.RequirePageScreenshotViewer(n=>{const s=[],e=document.querySelector('h1[itemprop="name"]').textContent;let r=null;document.querySelectorAll("#screenshots a").forEach((l,f)=>{s.push(l.href.substring(l.href.lastIndexOf("/")+1)),l.addEventListener("click",u=>{u.preventDefault(),r(f)})}),r=n(m,e,W,s).open});const oe=function(){const n=function(){const e=document.body.dataset.steamCdn,r=this.getAttribute("data-name");r&&this.setAttribute("src",e+"steamcommunity/public/images/apps/"+m+"/"+r)};document.querySelectorAll("#stats img").forEach(e=>{window.SteamDB.LazyLoad(e,n)});const s=document.getElementById("js-stats-api");if(s){const e=new URLSearchParams;e.append("appid",m),fetch(`/api/GetLoggedInAppStats/?${e}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(r=>r.json()).then(r=>{if(!r||!r.success){const a=new Error(r.error||"Something went wrong.");throw a.name="ServerError",a}s.textContent="\u2714 Your achievements and stats have been loaded.";for(const a of r.data.achievements){if(!a.achieved)continue;const l=document.querySelector(`#stats #achievement-${CSS.escape(`${a.name}`)} td:last-child`);l?l.textContent="\u2714":console.error("Failed to find element for",a.name)}for(const a of r.data.stats){const l=document.querySelector(`#stats #stat-${CSS.escape(`${a.name}`)} td:last-child`);l?l.textContent=a.value:console.error("Failed to find element for",a.name)}}).catch(r=>{throw s.textContent=`\u26A0 Sorry, failed to load: ${r}`,r})}},re=function(){const n=()=>{document.querySelectorAll("#screenshots a").forEach(r=>{const a=document.createElement("img");a.alt="",a.src=r.href.replace(".jpg",".600x338.jpg"),r.append(a)});const e=document.getElementById("js-movies");if(e){e.remove();const r=document.querySelector(".screenshots"),a=document.body.dataset.steamCdn,l=e.dataset.movies.split(",");for(const f of l){const u=document.createElement("video");u.preload="none",u.controls=!0,u.src=`${a}steam/apps/${f}/movie_max.webm`,u.poster=`${a}steam/apps/${f}/movie.293x165.jpg`,r.append(u)}}},s=document.getElementById("js-view-adult-screenshots");s?s.addEventListener("click",e=>{e.preventDefault(),n(),document.querySelector(".screenshots-adult-warning").hidden=!0,document.querySelector(".screenshots-adult").hidden=!1}):n()},ae=function(){const n=function(){this.dataset.src&&(this.src=this.dataset.src)};document.querySelectorAll("#communityitems img[data-src]").forEach(s=>{window.SteamDB.LazyLoad(s,n)}),window.SteamDB.RequirePageScreenshotViewer(s=>{const e=[],r="Trading cards \u2014 "+document.querySelector('h1[itemprop="name"]').textContent;let a=null;document.querySelectorAll("#communityitems .view-trading-card").forEach((l,f)=>{e.push(l.href),l.addEventListener("click",u=>{u.preventDefault(),a(f)})}),e.length>0&&(a=s(m,r,null,e).open)}),window.SteamDB.RequirePageScreenshotViewer(s=>{const e=[],r="Profile backgrounds \u2014 "+document.querySelector('h1[itemprop="name"]').textContent;let a=null;document.querySelectorAll("#communityitems .view-profile-background").forEach((l,f)=>{e.push(l.href),l.addEventListener("click",u=>{u.preventDefault(),a(f)})}),e.length>0&&(a=s(m,r,null,e).open)})},se=function(){const n=function(){this.dataset.src&&(this.src=this.dataset.src)},s=new URLSearchParams;s.append("section","items"),s.append("appid",m),fetch(`/api/RenderAppSection/?${s}`,{headers:{Accept:"text/html","X-Requested-With":"XMLHttpRequest"}}).then(e=>{if(!e.ok){const r=new Error(`HTTP ${e.status}`);throw r.name="ServerError",r}return e.text()}).then(e=>{document.querySelector("#items .items-loading").insertAdjacentHTML("afterend",e),document.querySelectorAll("#items img").forEach(r=>{window.SteamDB.LazyLoad(r,n)}),new window.List("items",{valueNames:["economy-item-name","economy-item-description"],page:50,pagination:{outerWindow:2}}),document.querySelector("#items .items-loading").hidden=!0,document.querySelector("#items .list").hidden=!1}).catch(e=>{if(document.querySelector("#items .items-loading").textContent=`\u26A0 Sorry, failed to load: ${e}`,e.name!=="ServerError")throw e})},ie=function(){SteamDB.RequireHighstock(function(){const s={chart:{},scrollbar:{enabled:!1},legend:{enabled:!0},exporting:{enabled:C},rangeSelector:{enabled:!0,inputEnabled:!1,buttons:[{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"year",count:3,text:"3y"},{type:"all",text:"all"}]},yAxis:{allowDecimals:!1,min:0},xAxis:{type:"datetime"},plotOptions:{flags:{width:16,height:16,color:"rgba(200, 255, 0, 0.2)",fillColor:"",style:{color:"#fff"},states:{hover:{lineColor:"rgba(200, 255, 0, 1)",fillColor:"#000"}}}}},e=window.g_ChartFlags||[];delete window.g_ChartFlags;let r=0,a=0;const l=new Date;l.setUTCHours(0,0,0,0);const f=l.getTime();if(x!==null){const p={x,text:"Steam Release",title:"Rel",id:"rel"};let t=e.length;for(let h=0;h<e.length;h++)if(e[h].x>x){t=h;break}e.splice(t,0,p)}const u=p=>p==="twitch"?!!window.SteamDB.Storage.Get(`app-chart-show-${p}`):!window.SteamDB.Storage.Get(`app-chart-hide-${p}`),g=p=>{if(p.target.options.id){if(p.target.options.id==="twitch"){if(m===753)return;const h=`app-chart-show-${p.target.options.id}`;p.target.visible?window.SteamDB.Storage.Remove(h):window.SteamDB.Storage.Set(h,1);return}const t=`app-chart-hide-${p.target.options.id}`;p.target.visible?window.SteamDB.Storage.Set(t,1):window.SteamDB.Storage.Remove(t)}};let y=!1;const _=()=>{if(y)return;y=!0;const p=new URLSearchParams;p.append("beta","1"),p.append("appid",m);const t=fetch(`/api/${C?"GetGraphWeekLoggedIn":"GetGraphWeek"}/?${p}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});fetch(`/api/${C?"GetGraphMaxLoggedIn":"GetGraphMax"}/?${p}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(i=>i.json()).then(i=>{if(!i){const o=new Error(i.error||"Something went wrong.");throw o.name="ServerError",o}i.data||(i.data=[]),i.data.start*=1e3,i.data.start_twitch*=1e3,i.data.start_mean*=1e3,i.data.step*=1e3,ee(i.data,e),t.then(o=>o.json()).then(o=>{if(!o){const v=new Error(o.error||"Something went wrong.");throw v.name="ServerError",v}o.data||(o.data={values:[]}),o.data.start*=1e3,o.data.start_twitch*=1e3,o.data.step*=1e3,o.data.start_mean=o.data.start;const d=(v,b)=>{const A=[];let S=i.data[v],T=o.data[v];if(S)for(const I of i.data[b]){if(S>=T)break;A.push([S,I]),S+=i.data.step}if(S=T,v==="start_mean"){const I=Z(o.data.values,24);for(const N of I)A.push([S,N]),S+=o.data.step;return A}if(S)if(v==="start"&&o.data.values_10m){T=o.data.start_10m*1e3,o.data.step_10m*=1e3;for(const I of o.data[b]){if(S>=T)break;A.push([S,I]),S+=o.data.step}S=T;for(const I of o.data.values_10m)A.push([S,I]),S+=o.data.step_10m}else if(v==="start_twitch"&&o.data.values_10m){T=o.data.start_10m*1e3;const I=o.data.step/o.data.step_10m,N=T+o.data.step_10m*(o.data.values_10m.length-1);for(const te of o.data[b]){if(A.push([S,te]),S>=T&&S<N)for(let O=1;O<I;O++)A.push([S+o.data.step_10m*O,te]);S+=o.data.step}}else for(const I of o.data[b])A.push([S,I]),S+=o.data.step;return A},c=d("start","values"),w=d("start_twitch","values_twitch");let E=null;C&&(E=d("start_mean","values_mean"));const j={click:function(){window.history.replaceState(null,null,`#${this.text}`)}},z={enabled:!0,approximation:"high",groupPixelWidth:C?10:20,units:[["hour",[1]],["day",[1]],["week",[1]],["month",[1]]]},X=[{type:"day",count:2,text:"48h",dataGrouping:{enabled:!1},events:j},{type:"week",count:1,text:"1w",dataGrouping:{enabled:!1},events:j},{type:"day",count:30,text:"1m",dataGrouping:z,events:j},{type:"month",count:3,text:"3m",dataGrouping:z,events:j},{type:"month",count:6,text:"6m",dataGrouping:z,events:j},{type:"year",count:1,text:"1y",dataGrouping:z,events:j}],fe=Math.floor((Date.now()-i.data.start)/3154e7)-3;for(let v=3;v<=fe;v+=3)X.push({type:"year",count:v,text:`${v}y`,dataGrouping:z,events:j});X.push({type:"all",text:"all",dataGrouping:z,events:j});const k={chart:{renderTo:"js-chart-week"},scrollbar:{enabled:!1},legend:{enabled:!0},exporting:{enabled:C},rangeSelector:{enabled:!0,inputEnabled:!1,selected:1,buttons:X},yAxis:{allowDecimals:!1,min:0},xAxis:{ordinal:!1,type:"datetime"},plotOptions:{series:{events:{legendItemClick:g},dataGrouping:z},flags:{width:16,height:16,stackDistance:24,color:"rgba(200, 255, 0, 0.2)",fillColor:"",style:{color:"#fff"},states:{hover:{lineColor:"rgba(200, 255, 0, 1)",fillColor:"#000"}}}},navigator:{series:{type:"areaspline",fillColor:"rgba(65, 77, 25, 0.7)"}},series:[{zIndex:4,lineWidth:2,type:"area",color:"var(--charts-players)",fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(65, 77, 25, 0.2)"],[1,"rgba(65, 77, 25, 0)"]]},name:M==="1"?"Players":"Users",id:"players",data:c}]};if(window.location.hash.length>0){const v=window.location.hash.substring(1);for(let b=0;b<k.rangeSelector.buttons.length;b++)if(k.rangeSelector.buttons[b].text===v){k.rangeSelector.selected=b;break}}else x&&x>o.data.start&&(k.chart.events={load:function(){const v=this.xAxis[0];v.setExtremes(x-x%o.data.step,v.max)}});if(E!=null&&E.length>0&&k.series.push({id:"players_trend",visible:u("players_trend"),zIndex:1,lineWidth:1,color:"#666",type:"line",name:M==="1"?"Average Players":"Average Users",data:E,enableMouseTracking:!1,zoneAxis:"x",zones:[{value:o.data.start},{dashStyle:"Dash"}]}),w.length>0&&k.series.push({id:"twitch",visible:m===753||u("twitch"),zIndex:2,lineWidth:1,color:"var(--charts-twitch)",type:"line",name:m===753?"In-Game":"Twitch Viewers",data:w}),e.length>0){const v=structuredClone(e.filter(b=>b.x>i.data.start));v.forEach(b=>{b.x<o.data.start&&(b.x-=b.x%864e5)}),k.series.push({id:"flags",visible:u("flags"),zIndex:10,type:"flags",name:"Markers",onSeries:"players",includeInDataExport:!1,data:v})}new Highcharts.StockChart(k)})}).catch(i=>{const o=document.querySelector("#js-chart-week");if(i.message==="No data."){o.textContent="There is no data for this.";return}if(o.textContent=`\u26A0 Sorry, failed to load this chart: ${i}`,i.name!=="ServerError")throw i})},R=()=>{const p=new URLSearchParams;p.append("appid",m),fetch(`/api/${C?"GetGraphWeekLoggedIn":"GetGraphWeek"}/?${p}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(t=>t.json()).then(t=>{if(!t||!t.data||!t.data.values){const d=new Error(t.error||"Something went wrong.");throw d.name="ServerError",d}t.data.start*=1e3,t.data.step*=1e3;const h=[{type:"day",count:2,text:"48h"}];C?h.push({type:"day",count:7,text:"1w"},{type:"all",text:"2w"}):h.push({type:"all",text:"1w"});const i=structuredClone(s);if(i.chart.renderTo="js-chart-week",i.plotOptions.series={events:{legendItemClick:g}},i.navigator={enabled:!1},i.rangeSelector={enabled:!0,inputEnabled:!1,buttons:h,buttonTheme:{width:40}},i.series=[{zIndex:4,lineWidth:2,type:"area",color:"var(--charts-players)",fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(65, 77, 25, 0.2)"],[1,"rgba(65, 77, 25, 0)"]]},name:M==="1"?"Players":"Users",id:"players",pointStart:t.data.start,pointInterval:t.data.step,data:t.data.values},{id:"players_trend",visible:u("players_trend"),zIndex:1,lineWidth:1,color:"#666",type:"line",name:M==="1"?"Players Trend":"Users Trend",dashStyle:"dash",pointStart:t.data.start,pointInterval:t.data.step,data:Z(t.data.values,24),enableMouseTracking:!1}],t.data.values_twitch&&i.series.push({id:"twitch",visible:m===753||u("twitch"),zIndex:2,lineWidth:1,color:"var(--charts-twitch)",type:"line",name:m===753?"In-Game":"Twitch Viewers",pointStart:t.data.start_twitch*1e3,pointInterval:t.data.step,data:t.data.values_twitch}),x&&x>t.data.start&&(i.chart.events={load:function(){const d=this.xAxis[0];d.setExtremes(x-x%t.data.step,d.max)}}),e.length>0){const d=e.filter(function(c){return c.x>t.data.start});d.length>0&&i.series.push({id:"flags",visible:u("flags"),zIndex:10,type:"flags",name:"Markers",onSeries:"players",includeInDataExport:!1,data:d})}new Highcharts.StockChart(i);const o=f-t.data.start;if(o>0&&t.data.step<36e5){for(let d=Math.floor(o/t.data.step);d<t.data.values.length;d++){const c=t.data.values[d];r<c&&(r=c)}if(t.data.values_twitch)for(let d=Math.floor(o/t.data.step);d<t.data.values_twitch.length;d++){const c=t.data.values_twitch[d];a<c&&(a=c)}}}).catch(t=>{const h=document.querySelector("#js-chart-week");if(t.message==="No data."){h.textContent="There is no data for this.";return}if(h.textContent=`\u26A0 Sorry, failed to load this chart: ${t}`,t.name!=="ServerError")throw t})},D=()=>{if(y)return;y=!0;const p=new URLSearchParams;p.append("appid",m),fetch(`/api/${C?"GetGraphMaxLoggedIn":"GetGraphMax"}/?${p}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(t=>t.json()).then(t=>{if(!t||!t.data){const i=new Error(t.error||"Something went wrong.");throw i.name="ServerError",i}t.data.start*=1e3,t.data.step*=1e3,t.data.start_mean*=1e3,t.data.start_twitch*=1e3,ee(t.data,e),r>0&&t.data.values.length>0&&t.data.values.push(r);const h=structuredClone(s);if(h.chart.renderTo="js-chart-year",h.navigator={adaptToUpdatedData:!1},h.series=[{zIndex:4,lineWidth:2,type:"area",color:"var(--charts-players)",fillColor:{linearGradient:{x1:0,x2:0,y1:0,y2:1},stops:[[0,"rgba(65, 77, 25, 0.2)"],[1,"rgba(65, 77, 25, 0)"]]},name:M==="1"?"Players":"Users",id:"players",pointStart:t.data.start,pointInterval:t.data.step,data:t.data.values}],h.plotOptions.series={events:{legendItemClick:g},marker:{enabled:!0,radius:1},dataGrouping:{enabled:!0,approximation:"high",groupPixelWidth:2,units:[["day",[1]],["week",[1]]]},zoneAxis:"x",zones:[{value:f-1e3*60*60*24},{dashStyle:"dash"}]},t.data.values_mean&&t.data.values_mean.length>0&&(r>0&&t.data.values_mean.push(t.data.values_mean[t.data.values_mean.length-1]),h.series.push({id:"players_trend",visible:u("players_trend"),zIndex:1,lineWidth:1,color:"#666",type:"line",name:M==="1"?"Average Players":"Average Users",pointStart:t.data.start_mean,pointInterval:t.data.step,data:t.data.values_mean})),t.data.values_twitch&&(a>0&&t.data.values_twitch.push(a),h.series.push({id:"twitch",visible:m===753||u("twitch"),zIndex:2,lineWidth:1,color:"var(--charts-twitch)",type:"line",name:m===753?"In-Game":"Twitch Viewers",pointStart:t.data.start_twitch,pointInterval:t.data.step,data:t.data.values_twitch})),x&&(h.chart.events={load:function(){const i=this.xAxis[0];i.setExtremes(x-x%t.data.step,i.max)}}),e.length>0){const i=structuredClone(e.filter(o=>o.x>t.data.start));i.forEach(o=>{o.x-=o.x%864e5}),h.series.push({id:"flags",visible:u("flags"),zIndex:10,type:"flags",name:"Markers",onSeries:"players",includeInDataExport:!1,data:i})}new Highcharts.StockChart(h)}).catch(t=>{const h=document.querySelector("#js-chart-year");if(t.message==="No data."){h.textContent="There is no data for this.";return}if(h.textContent=`\u26A0 Sorry, failed to load this chart: ${t}`,t.name!=="ServerError")throw t})},G=()=>{const p=new URLSearchParams;p.append("appid",m),fetch(`/api/GetGraphFollowers/?${p}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(t=>t.json()).then(t=>{if(!t||!t.data){const i=new Error(t.error||"Something went wrong.");throw i.name="ServerError",i}t.data.start*=1e3,t.data.step*=1e3;const h=structuredClone(s);if(h.chart.renderTo="js-chart-followers",h.navigator={enabled:!1},h.series=[{zIndex:1,color:"#0277BD",type:"line",name:"Followers",id:"followers",pointStart:t.data.start,pointInterval:t.data.step,data:t.data.values}],e.length>0){const i=structuredClone(e.filter(o=>o.x>t.data.start));i.forEach(o=>{o.x-=o.x%864e5}),h.series.push({zIndex:10,type:"flags",name:"Markers",onSeries:"followers",includeInDataExport:!1,data:i})}new Highcharts.StockChart(h)}).catch(t=>{const h=document.querySelector("#js-chart-followers");if(t.message==="No data."){h.textContent="There is no data for this.";return}if(h.textContent=`\u26A0 Sorry, failed to load this chart: ${t}`,t.name!=="ServerError")throw t})},$=document.getElementById("js-chart-week"),H=document.getElementById("js-chart-year"),q=document.getElementById("js-chart-followers");{$&&window.SteamDB.LazyLoad($,_),q&&!P&&window.SteamDB.LazyLoad(q,G);const p=document.getElementById("js-chart-month-loading");p&&window.SteamDB.LazyLoad(p,_);return}if($&&!P&&window.SteamDB.LazyLoad($,R),H){window.SteamDB.LazyLoad(H,D);const p=document.getElementById("js-chart-month-loading");p&&window.SteamDB.LazyLoad(p,D)}q&&!P&&window.SteamDB.LazyLoad(q,G)});const n=document.getElementById("js-embed-button");n&&n.addEventListener("click",function(){const s=document.getElementById("js-embed-code"),e=s.querySelector("pre");e.insertAdjacentHTML("afterend",e.textContent),this.hidden=!0,s.hidden=!1;const r=document.createRange();r.selectNodeContents(e);const a=window.getSelection();return a.removeAllRanges(),a.addRange(r),!1})},ce=function(){if(P)return;const n=document.getElementById("js-price-history"),s=document.getElementById("js-chart-prices"),e=document.getElementById("js-store-iframe");s&&window.SteamDB.LazyLoad(s,()=>{Y||n.click()}),e&&window.SteamDB.LazyLoad(e,()=>{e.src=e.dataset.src})},le=function(){const n=document.querySelector("#js-linked-apps"),s=new URLSearchParams;s.append("appid",m),fetch(`/api/RenderLinkedApps/?${s}`,{headers:{Accept:"text/html","X-Requested-With":"XMLHttpRequest"}}).then(e=>{if(!e.ok){const r=new Error(`HTTP ${e.status}`);throw r.name="ServerError",r}return e.text()}).then(e=>{n.innerHTML=e,n.querySelectorAll(".timeago").forEach(r=>TimeAgo.init(r)),window.SteamDB.EnhanceLazyLoadedApps(n),new Tablesort(n.querySelector(".table"))}).catch(()=>{n.textContent="This app is not referenced by any other app that we are aware of."})},de=function(){const n=document.getElementById("js-all-localization");n&&n.addEventListener("click",function(){const s=document.getElementById("localization");s.innerHTML='<h3>Loading all localization strings</h3><span class="loader"></span>';const e=new URLSearchParams;e.append("section","localization"),e.append("appid",m),fetch(`/api/RenderAppSection/?${e}`,{headers:{Accept:"text/html","X-Requested-With":"XMLHttpRequest"}}).then(r=>{if(!r.ok){const a=new Error(`HTTP ${r.status}`);throw a.name="ServerError",a}return r.text()}).then(r=>{s.innerHTML=r}).catch(r=>{if(s.textContent=`\u26A0 Sorry, failed to load: ${r}`,r.name!=="ServerError")throw r}),s.scrollIntoView({behavior:"smooth",block:"nearest"})})},B=function(n,s){if(ne===n)s();else{const e=document.getElementById(`tab-${n}`);e&&e.addEventListener("tab-shown",s,{once:!0})}},J=document.getElementById("js-charts-button");J&&J.addEventListener("click",function(n){n.preventDefault(),document.getElementById("tab-charts").click()});const K=document.getElementById("js-currency-selector");K&&(K.addEventListener("click",function(n){n.preventDefault(),document.querySelector(".currency-selector").classList.toggle("shown")}),document.querySelectorAll(".currency-selector .btn").forEach(n=>{n.addEventListener("click",function(s){s.preventDefault();const e=this.dataset.cc;document.cookie="__Host-cc="+e+"; path=/; secure; samesite=lax; max-age=7776000",window.location.replace(window.location.pathname)})})),document.querySelectorAll(".price-line").forEach(n=>{n.addEventListener("click",function(s){Y=!0;const e=this.dataset.cc;document.getElementById("js-chart-prices").innerHTML='<span class="loader"></span><p>Loading price history\u2026</p>',document.getElementById("pricehistory").textContent=`Price history (${e.toUpperCase()})`,SteamDB.RequireHighstock(function(){const r=new URLSearchParams;r.append("appid",m),r.append("cc",e),fetch(`/api/${C?"GetPriceHistoryLoggedIn":"GetPriceHistory"}/?${r}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}).then(a=>{if(a.headers.get("X-SteamDB-History-More")){const l=document.getElementById("js-prices-truncated");l&&(l.hidden=!1)}return a.json()}).then(a=>{if(!a||!a.success){const g=new Error(a.error||"Something went wrong.");throw g.name="ServerError",g}const l=[];a=a.data;let f=Number.MAX_SAFE_INTEGER;if(a.history.length>0){let g=Date.now();(e==="old-try"||e==="old-ars")&&(g=17005032e5);let y={...a.history[a.history.length-1]};y.x=g,a.history.push(y);for(y of a.history)f>y.y&&(f=y.y);f>0&&l.push({value:f,color:"var(--muted-color)",dashStyle:"Dot",width:1})}const u={chart:{renderTo:"js-chart-prices"},scrollbar:{enabled:!1},legend:{enabled:!0},navigator:{enabled:!1},rangeSelector:{enabled:!0,inputEnabled:!1,selected:3,buttons:[{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"year",count:2,text:"2y"},{type:"year",count:3,text:"3y"},{type:"year",count:6,text:"6y"},{type:"all",text:"all"}]},tooltip:{xDateFormat:"%A, %b %e, %Y"},yAxis:{gridLineWidth:0,minorGridLineWidth:0,min:0,plotLines:l},xAxis:{ordinal:!1,type:"datetime"},series:[{id:"price",step:!0,color:"var(--charts-players)",type:"line",name:"Final price",data:a.history,lineWidth:2,tooltip:{pointFormatter:function(){let g="";const y=this;return y.d>0?(g+='Price: <b style="color:var(--tooltip-green)">'+y.f+"</b>",g+="<br/>Discount: <b>-"+y.d+"%</b>"):y.y?g+="Price: <b>"+y.f+"</b><br/>No discount":g+="No Price",a.sales[this.x]&&(g+=`<br/><br/><b style="color:var(--tooltip-green)">${a.sales[this.x]}</b>`),g}}}]};if(x!==null&&(C||a.history.length>0&&x+864e5>a.history[0].x)){const g={x,text:"Steam Release",title:"Rel"};a.history.length>0&&Math.abs(g.x-a.history[0].x)<864e5&&(g.x=a.history[0].x),u.series.push({zIndex:10,type:"flags",name:"Markers",onSeries:"price",includeInDataExport:!1,width:16,height:16,data:[g],y:-60,color:"rgba(150, 150, 150, 0.2)",fillColor:"",style:{color:"#fff"},states:{hover:{fillColor:"#000"}}})}new Highcharts.StockChart(u)}).catch(a=>{const l=document.querySelector("#js-chart-prices");if(a.message==="No data."){l.textContent="There is no price history for this.";return}if(l.textContent=`\u26A0 Sorry, failed to load price history: ${a}`,a.name!=="ServerError")throw a})}),s.isTrusted&&document.querySelector("#js-chart-prices").scrollIntoView({behavior:"smooth",block:"nearest"})})}),document.querySelectorAll(".table-sortable").forEach(n=>{Tablesort(n)}),B("prices",ce),B("stats",oe),B("items",se),B("charts",ie),B("screenshots",re),B("communityitems",ae),B("linked",le),B("localization",de),Q(document.querySelectorAll(".image-hover")),window.SteamDB.BindImageHover=Q;function Q(n){for(let s=0;s<n.length;s++)n[s].addEventListener("pointerenter",he,{passive:!0}),n[s].addEventListener("pointerleave",ue,{passive:!0})}let L=null;function he(n){L&&L.remove(),L=document.createElement("img"),L.className="hover-image",L.src=this.dataset.src||this.href,L.addEventListener("load",()=>{if(!L)return;const s=document.getElementById("js-hover");s.appendChild(L),s.hidden=!1;const e=n.target.getBoundingClientRect();s.style.top=e.bottom+window.scrollY+"px",s.style.left=e.x+"px"})}function ue(){if(!L)return;const n=document.getElementById("js-hover");n.hidden=!0,n.style.top=null,n.style.left=null,L.onload=null,L.src="",L.remove(),L=null}function Z(n,s){const e=me(n,s),r=pe(n,s),a=[];for(let l=0;l<n.length;l++){const f=(n.length-l)/n.length;a[l]=Math.round(f*e[l]+(1-f)*r[l])}return a}function pe(n,s){const e=[n[0]],r=[n[0]];for(let a=1;a<n.length;a++)r.push(n[a]),e[a]=F(r),r.length>=s&&r.shift();return e}function me(n,s){const e=[],r=n.slice(0,s);for(let a=0;a<n.length;a++)e[a]=F(r),r.shift(),a<n.length-s&&r.push(n[a+s]);return e}function F(n){const s=1/n.length;let e=0;for(const r of n)e+=s*r;return e}function ee(n,s){const e=document.getElementById("chart-month-table");if(!e)return;const r=document.getElementById("js-chart-month-loading");if(!n.start){r.textContent="No data yet.";return}const a=["January","February","March","April","May","June","July","August","September","October","November","December"],l=new Map,f=n.step;let u=n.start,g,y=0,_=0,R=0,D=0;const G=()=>{_=0,D<s.length?(y=s[D].x,y-=y%864e5):y=Number.MAX_SAFE_INTEGER,D++,D<s.length?(R=s[D].x,R-=R%864e5):R=Number.MAX_SAFE_INTEGER},$=()=>{if(_===0)return;const i=s[D-1].id,o=document.getElementById(`js-marker-${i}`);o&&(o.textContent=_.toLocaleString("en-US"),o.dataset.sort=_.toString())};G();for(const i of n.values){if(i!==null){const o=new Date(u),d=o.getFullYear(),c=o.getMonth(),w=(d-1970)*12+c;l.has(w)?l.get(w).values.push(i):l.set(w,{name:`${a[c]} ${d}`,values:[i],values_mean:[],values_twitch:[]}),g=w}u>=R&&($(),G()),u>=y&&u<=y+2592e6&&_<i&&(_=i),u+=f}if($(),!l.size){r.textContent="No data yet.";return}if(n.values_mean){u=n.start_mean;for(const i of n.values_mean){if(i!==null){const o=new Date(u),d=o.getFullYear(),c=o.getMonth(),w=(d-1970)*12+c;l.has(w)&&l.get(w).values_mean.push(i)}u+=f}}if(n.values_twitch){u=n.start_twitch;for(const i of n.values_twitch){if(i!==null){const o=new Date(u),d=o.getFullYear(),c=o.getMonth(),w=(d-1970)*12+c;l.has(w)&&l.get(w).values_twitch.push(i)}u+=f}}l.has(632)&&(l.get(632).values_mean=[]);const H=n.step<1e8?-30:-2,q=l.get(g);q.name="Last 30 days",q.values=n.values.slice(H).filter(i=>i!==null),n.values_mean&&(q.values_mean=n.values_mean.slice(H).filter(i=>i!==null)),n.values_twitch&&(q.values_twitch=n.values_twitch.slice(H).filter(i=>i!==null));const p=document.createDocumentFragment();let t=0,h=0;for(const[i,o]of l){o.max=0,o.max_twitch=0;for(const d of o.values)o.max<d&&(o.max=d);for(const d of o.values_twitch)o.max_twitch<d&&(o.max_twitch=d);o.avg=Math.round(F(o.values_mean))}for(const[i,o]of l){const d=document.createElement("tr");p.appendChild(d);let c=document.createElement("td");if(c.dataset.sort=i,c.textContent=o.name,d.appendChild(c),c=document.createElement("td"),c.dataset.sort=o.max,c.textContent=o.max.toLocaleString("en-US"),d.appendChild(c),t>0){const w=o.max-t,E=w/t*100;c=document.createElement("td"),c.dataset.sort=w,c.textContent=(w>0?"+":"")+w.toLocaleString("en-US"),c.className="price-discount"+(w>0?"":"-minor"),d.appendChild(c),c=document.createElement("td"),c.dataset.sort=Math.round(E),E>=1e6?c.textContent="\u221E":c.textContent=(E>=0?"+":"")+E.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1})+"%",c.className="price-discount"+(w>0?"":"-minor"),d.appendChild(c)}else c=document.createElement("td"),c.textContent="-",d.appendChild(c),c=document.createElement("td"),c.textContent="-",d.appendChild(c);if(c=document.createElement("td"),c.dataset.sort=o.avg,c.classList.add("table-prices-converted"),c.textContent=o.avg>0?o.avg.toLocaleString("en-US"):"-",d.appendChild(c),h>0){const w=o.avg-h,E=w/h*100;c=document.createElement("td"),c.dataset.sort=Math.round(E),E>=1e6?c.textContent="\u221E":c.textContent=(E>=0?"+":"")+E.toLocaleString("en-US",{minimumFractionDigits:1,maximumFractionDigits:1})+"%",c.className="table-prices-converted price-discount"+(w>0?"":"-minor"),d.appendChild(c)}else c=document.createElement("td"),c.classList.add("table-prices-converted"),c.textContent="-",d.appendChild(c);c=document.createElement("td"),c.dataset.sort=o.max_twitch,c.textContent=o.max_twitch>0?o.max_twitch.toLocaleString("en-US"):"-",d.appendChild(c),t=o.max,h=o.avg}e.querySelector("tbody").append(p),new Tablesort(e),e.hidden=!1,r.hidden=!0}})();
